# Steamji Docker éƒ¨ç½²éªŒè¯æŒ‡å—

## å½“å‰çŠ¶æ€æ£€æŸ¥

### âœ… ç¯å¢ƒå˜é‡é…ç½®éªŒè¯å®Œæˆ
- **æ•°æ®åº“é…ç½®**ï¼šæ‰€æœ‰å‚æ•°å·²æ­£ç¡®è®¾ç½®
- **Strapié…ç½®**ï¼šç«¯å£å’Œå®‰å…¨å¯†é’¥å·²é…ç½®
- **ASFé…ç½®**ï¼šIPCå¯†ç å’Œç«¯å£å·²è®¾ç½®

### ğŸ”§ é…ç½®ä¸€è‡´æ€§éªŒè¯

**æ•°æ®åº“è¿æ¥å‚æ•°åŒ¹é…**ï¼š
- `POSTGRES_DB=steamji` â†’ `${POSTGRES_DB}` âœ…
- `POSTGRES_USER=steamji` â†’ `${POSTGRES_USER}` âœ…  
- `POSTGRES_PASSWORD=steamji_passwd0` â†’ `${POSTGRES_PASSWORD}` âœ…

**ç«¯å£æ˜ å°„é…ç½®**ï¼š
- PostgreSQLå®¹å™¨ï¼š`5433:5432`ï¼ˆå¤–éƒ¨:å†…éƒ¨ï¼‰
- Strapiå®¹å™¨ï¼š`1337:1337`
- ASFå®¹å™¨ï¼š`2222:1242`

## ğŸš€ éƒ¨ç½²å‰å‡†å¤‡

### 1. å®‰è£…Dockerç¯å¢ƒ
ç³»ç»Ÿæ£€æµ‹åˆ°Dockeræœªå®‰è£…ï¼Œéœ€è¦å…ˆå®‰è£…Dockerï¼š

**macOSå®‰è£…**ï¼š
```bash
# ä½¿ç”¨Homebrewå®‰è£…
brew install --cask docker

# æˆ–ä»å®˜ç½‘ä¸‹è½½Docker Desktop
# https://www.docker.com/products/docker-desktop
```

**éªŒè¯å®‰è£…**ï¼š
```bash
docker --version
docker compose version
```

### 2. å¯åŠ¨DockeræœåŠ¡
- æ‰“å¼€Docker Desktopåº”ç”¨ç¨‹åº
- ç­‰å¾…Dockerå®ˆæŠ¤è¿›ç¨‹å¯åŠ¨

## ğŸ“‹ éƒ¨ç½²æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šéªŒè¯Dockerç¯å¢ƒ
```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
docker --version
docker compose version
```

### ç¬¬äºŒæ­¥ï¼šæ„å»ºå’Œå¯åŠ¨æœåŠ¡

**æ–¹å¼ä¸€ï¼šåœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼ˆæ¨èï¼‰**
```bash
# åœæ­¢ç°æœ‰æœåŠ¡ï¼ˆå¦‚æœæœ‰ï¼‰
docker compose -f docker/docker-compose.yaml down

# é‡æ–°æ„å»ºé•œåƒ
docker compose -f docker/docker-compose.yaml build --no-cache

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker compose -f docker/docker-compose.yaml up -d
```

**æ–¹å¼äºŒï¼šåœ¨dockerç›®å½•æ‰§è¡Œ**
```bash
cd docker

# åœæ­¢ç°æœ‰æœåŠ¡ï¼ˆå¦‚æœæœ‰ï¼‰
docker compose down

# é‡æ–°æ„å»ºé•œåƒ
docker compose build --no-cache

# å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker compose up -d
```

### ç¬¬ä¸‰æ­¥ï¼šéªŒè¯æœåŠ¡çŠ¶æ€
```bash
# æ£€æŸ¥æ‰€æœ‰å®¹å™¨çŠ¶æ€
docker compose ps

# æŸ¥çœ‹Strapiæ—¥å¿—
docker compose logs -f strapi

# æŸ¥çœ‹PostgreSQLæ—¥å¿—  
docker compose logs -f postgres

# æŸ¥çœ‹ASFæ—¥å¿—
docker compose logs -f asf
```

## ğŸ” é¢„æœŸç»“æœ

### StrapiæœåŠ¡å¯åŠ¨æˆåŠŸæ ‡å¿—ï¼š
- âœ… è¿æ¥åˆ° `postgres:5432` è€Œä¸æ˜¯ `127.0.0.1:5432`
- âœ… ä¸å†å‡ºç°"ECONNREFUSED"é”™è¯¯
- âœ… æ˜¾ç¤º"Server started"æˆ–ç±»ä¼¼æˆåŠŸæ¶ˆæ¯

### PostgreSQLæœåŠ¡éªŒè¯ï¼š
```bash
# è¿æ¥åˆ°PostgreSQLéªŒè¯
docker compose exec postgres psql -U steamji -d steamji -c "SELECT version();"
```

### ASFæœåŠ¡éªŒè¯ï¼š
- è®¿é—® http://localhost:2222 æŸ¥çœ‹ASFæ§åˆ¶é¢æ¿

## âŒ å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜1ï¼šDockerå‘½ä»¤æœªæ‰¾åˆ°
**è§£å†³æ–¹æ¡ˆ**ï¼šå®‰è£…Docker Desktopæˆ–Docker Engine

### é—®é¢˜2ï¼šç«¯å£å†²çª
**è§£å†³æ–¹æ¡ˆ**ï¼šä¿®æ”¹.envæ–‡ä»¶ä¸­çš„ç«¯å£å·
```env
POSTGRES_EXTERNAL_PORT=5434
STRAPI_EXTERNAL_PORT=1338  
ASF_EXTERNAL_PORT=2223
```

### é—®é¢˜3ï¼šæƒé™é”™è¯¯
**è§£å†³æ–¹æ¡ˆ**ï¼šç¡®ä¿æœ‰è¶³å¤Ÿçš„æƒé™è¿è¡ŒDockerå‘½ä»¤

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœéƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. Dockeræ—¥å¿—è¾“å‡º
2. å®¹å™¨çŠ¶æ€ï¼š`docker compose ps`
3. æœåŠ¡å¥åº·æ£€æŸ¥ï¼š`docker compose logs`

å½“å‰é…ç½®å·²éªŒè¯æ­£ç¡®ï¼Œç­‰å¾…Dockerç¯å¢ƒå®‰è£…åå³å¯éƒ¨ç½²ã€‚